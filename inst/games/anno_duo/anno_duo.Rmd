---
title: "The First Real Game"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  fig.width=8,
  fig.height=8
)
```


```{r, include=FALSE}
devtools::load_all()
library(MundusCentrum)
game <- do.call(new_game, args = jsonlite::fromJSON("anno_duo.json", simplifyVector = FALSE))
```

```{r, echo = FALSE, results = "asis"}
cat("# {{PLAYER}}")
```

### see the starting point
This is the state of the game at the beginning

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# TURN 1
Players change their maps (making orders)

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", 1,   "move",  c("D3", "C2")) %>%
  modify_unit("big_grizz", c(2, 7, 17, 18),   "control",  "D4") %>%
  modify_unit("big_grizz", c(3, 5:6, 13, 22),   "soar",  c("F5", "H2")) %>% # transport
  modify_unit("big_grizz", c(8, 23),   "move",  c("D3", "C4", "C5")) %>% # transport
  modify_unit("big_grizz", 9,   "move",  "F5") %>%
  modify_unit("big_grizz", c(10:12, 16),   "move",  c("D2", "D1")) %>%
  modify_unit("big_grizz", c(14:15, 19:21),   "move",  "F5") %>%
  modify_unit("eric",      c(1:6, 13:14, 8:11),   "move",  "E7") %>%
  modify_unit("eric",      7,     "control","G7") %>%
  modify_unit("eric",      12,     "move", c("E7", "E5")) %>%
  modify_unit("eric",      15:18,   "soar", c("G8", "G10", "I1", "I3", "I4")) %>% # transport IS THIS LEGAL? you move 5 spaces here...
  modify_unit("eric",      19,   "move","G6") %>%
  modify_unit("eric",      20,   "move", c("E7", "E6")) %>%
  modify_unit("eric",      21,   "move", c("E7", "E4")) %>% 
  modify_unit("eric",      c(22:24, 26),   "soar", c("G8", "H3")) %>% # transport 
  modify_unit("eric",      25,   "move","G8") %>%
  modify_unit("eric",      27,   "move", c("E7", "F4")) %>%
  modify_unit("eric",      28,   "move", c("E7", "F8")) %>% # cool example here of if you got waylaid in E7 you would have strength together
  modify_unit("chris",     c(6, 13),  "move","A2") %>%
  modify_unit("chris",     c(5, 7, 8, 12, 23),  "move","A3") %>%
  modify_unit("chris",     1,  "move","A4") %>%
  modify_unit("chris",     c(10, 14, 24),  "move","A6") %>%
  modify_unit("chris",     c(3, 9, 17, 18, 22),  "move","A7") %>%
  modify_unit("chris",     2,  "move", c("A6", "A8")) %>%
  modify_unit("chris",     19,  "move",c("B7", "B10")) %>%
  modify_unit("chris",     21,  "move", c("B9", "B11")) %>%
  modify_unit("chris",     c(4, 15),  "move","B7") %>%
  modify_unit("chris",     20,  "move", c("A7", "E1")) %>%
  modify_unit("chris",     c(11, 16, 25),  "control","A5") %>%
  reconcile_player_orders()

```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# TURN 2
Players change their maps (making orders)

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", 1,   "move",  c("C1", "B4")) %>%
  modify_unit("big_grizz", 7,   "move",  "D2") %>%
  modify_unit("big_grizz", 6,   "move",  "H5") %>%
  modify_unit("big_grizz", c(3, 5, 13, 22),   "control",  "H2") %>%
  modify_unit("big_grizz", c(8, 23),   "control",  "C5") %>%
  modify_unit("big_grizz", 9,   "control",  "F5") %>%
  modify_unit("big_grizz", c(10:12, 16),   "move",  c("B1", "B4")) %>%
  modify_unit("big_grizz", c(14:15, 19:21),   "move",  "C5") %>%
  modify_unit("eric",      c(1:6, 13:14, 8:11),   "move",  "E5") %>%
  modify_unit("eric",      7,     "move","E7") %>%
  modify_unit("eric",      12,     "move", c("F3", "F2")) %>%
  modify_unit("eric",      c(15,18),     "control","I4") %>%
  modify_unit("eric",      16:17,   "move","I5") %>%
  modify_unit("eric",      19,   "control","G6") %>%
  modify_unit("eric",      20,   "move", c("E4", "E3")) %>%
  modify_unit("eric",      21,   "move", c("E1", "A8")) %>%
  modify_unit("eric",      c(22:24, 26),   "move","H2") %>%
  modify_unit("eric",      25,   "control","G8") %>%
  modify_unit("eric",      27,   "move", c("F7", "F5")) %>%
  modify_unit("eric",      28,   "move", c("H1", "H3")) %>%
  modify_unit("chris",     c(6),  "move","A4") %>%
  modify_unit("chris",     c(13),  "control","A2") %>%
  modify_unit("chris",     c(5, 12, 23),  "move","B2") %>%
  modify_unit("chris",     c(7, 8),  "control","A3") %>%
  modify_unit("chris",     1,  "move", c("A6", "A8")) %>%
  modify_unit("chris",     c(14),  "control","A6") %>%
  modify_unit("chris",     c(10, 24),  "move","A8") %>%
  modify_unit("chris",     c(3,17, 18, 22),  "move","B9") %>%
  modify_unit("chris",     c(9),  "control","A7") %>%
  modify_unit("chris",     2,  "move", "E1") %>%
  modify_unit("chris",     19,  "move", c("B11", "E1")) %>%
  modify_unit("chris",     21,  "move","B6") %>%
  modify_unit("chris",     4,  "move","B8") %>%
  modify_unit("chris",     15,  "move","B9") %>%
  modify_unit("chris",     20,  "move", c("B11", "E2")) %>%
  modify_unit("chris",     11,  "move","B7") %>%
  modify_unit("chris",     c(16, 25),  "control","A5") %>%
  reconcile_player_orders()
```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

### moves

```{r}
# retreats
game <- game %>%
  modify_unit("eric", "F5",   "move","F8") %>%
  kill_unit("eric", 21) %>%
  modify_unit("eric", "H2",   "move","H3") %>%
  reconcile_player_orders()
```

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```


# TURN 3
Players change their maps (making orders)

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", c(1, 10, 11, 12, 16),   "move",  c("B1", "B3")) %>%
  modify_unit("big_grizz", 7,   "control",  "D2") %>%
  modify_unit("big_grizz", 6,   "control",  "H5") %>%
  modify_unit("big_grizz", c(3, 5, 13, 22),   "move",  "H3") %>%
  modify_unit("big_grizz", c(8, 20, 21, 23),   "move",  "C3") %>%
  modify_unit("big_grizz", 9,   "sneak",  "C4") %>%
  modify_unit("big_grizz", c(4, 15, 19),   "sneak",  "C3") %>%
  modify_unit("big_grizz", 14,   "reinforce",  "C5") %>%
  
  modify_unit("eric", 1, "move",	"F3") %>%
  modify_unit("eric", 2, "move",	"F3") %>%
  modify_unit("eric", 3, "move",	"F4") %>%
  modify_unit("eric", 4, "move",	"F3") %>%
  modify_unit("eric", 5, "move",	"F3") %>%
  modify_unit("eric", 6, "move",	"F3") %>%
  modify_unit("eric", 7, "move",	"E5") %>%
  modify_unit("eric", 8, "move",	"F4") %>%
  modify_unit("eric", 9, "move",	"F3") %>%
  modify_unit("eric", 10, "move",	"F4") %>%
  modify_unit("eric", 11, "move",	"F3") %>%
  modify_unit("eric", 12, "move",	c("C3", "F7")) %>%
  modify_unit("eric", 13, "move",	"F3") %>%
  modify_unit("eric", 14, "sneak",	"E5") %>%
  modify_unit("eric", 15, "move",	"I5") %>%
  modify_unit("eric", 16, "move",	"I5") %>%
  modify_unit("eric", 17, "move",	"I4") %>%
  modify_unit("eric", 18, "control",	"I4") %>%
  modify_unit("eric", 19, "move",	"G9") %>%
  modify_unit("eric", 20, "move",	"E4") %>%
  modify_unit("eric", 21, "rejoin",	"G7") %>%
  modify_unit("eric", 22, "move",	"H5") %>%
  modify_unit("eric", 23, "move",	"H5") %>%
  modify_unit("eric", 24, "move",	"H5") %>%
  modify_unit("eric", 25, "move",	"G10") %>%
  modify_unit("eric", 26, "move",	"H5") %>%
  modify_unit("eric", 27, "move",	"F7") %>%
  modify_unit("eric", 28, "reinforce",	"H3") %>%

  modify_unit("chris", c(20), "defend", "E2") %>%
  modify_unit("chris", c(5, 23), "defend", "B2") %>%
  modify_unit("chris", c(16, 25), "defend", "A5") %>%
  modify_unit("chris", 3, "sneak", "B11") %>%
  modify_unit("chris", c(1,17,18) , "move", "B11") %>%
  modify_unit("chris", 2, "move", "E2") %>%
  modify_unit("chris", c(4) , "sneak", "B2") %>%
  modify_unit("chris", c(7) , "move", "B2") %>%
  modify_unit("chris", 6, "move", "A1") %>%
  modify_unit("chris", 8, "move", "B5") %>%
  modify_unit("chris", 9, "sneak", "B9") %>%
  modify_unit("chris", c(10) , "sneak", "E1") %>%
  modify_unit("chris", c(24) , "move", "E1") %>%
  modify_unit("chris", 11, "control", "B7") %>%
  modify_unit("chris", 12, "control", "B2") %>%
  modify_unit("chris", 13, "move", "A4") %>%
  modify_unit("chris", 14, "move", "A1") %>%
  modify_unit("chris", 15, "control", "B9") %>%
  modify_unit("chris", 19, "move", "E3") %>%
  modify_unit("chris", 21, "move", "B3") %>%
  modify_unit("chris", 22, "move", "B7") %>%

  reconcile_player_orders()
```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```


```{r, include = FALSE}
#**PRETENDING EVERYBODY RETREATS TO SEE THE FULL BOARD**
# retreats
game <- game %>%
  modify_unit("big_grizz", c(1, 10, 11, 12, 16),   "move",  c("B1")) %>%
  modify_unit("big_grizz", c(3, 5, 13, 22),   "move",  "H2") %>%
  modify_unit("big_grizz", "H5",   "move",  "H2") %>%
  modify_unit("eric", "C3",   "move",  "F2") %>%
  modify_unit("chris",     19,  "move","E1") %>%
  reconcile_player_orders()

print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```


# Discussion Notes

* I updated the multi-territory moves for the first two turns. Are we cool with my decisions?
* The way I have it, after you move you can only see the units in combat. You don't get to see the full board until _after_ combat is resolved. This was intentional on my part, but do we like this?
* Whose gonna write me a battle story for this turn?
