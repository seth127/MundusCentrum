---
title: "The First Real Game"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  fig.width=8,
  fig.height=8
)
```


```{r, include=FALSE}
devtools::load_all()
library(MundusCentrum)
game <- do.call(new_game, args = jsonlite::fromJSON("anno_duo.json", simplifyVector = FALSE))
```

```{r, echo = FALSE, results = "asis"}
cat("# {{PLAYER}}")
```

## Turns

* [Turn 1](#turn1)
* [Turn 2](#turn2)
* [Turn 3](#turn3)
* [Turn 4](#turn4)

### see the starting point
This is the state of the game at the beginning

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# TURN 1 {#turn1}

```
Mundus Centrum Campaign
0.248.853.M41

++++++TRANSMITTED: MUNDUS CENTRUM
+++++++++RECEIVED: THE ROCK
+++++++++++AUTHOR: DEATHWING CAPTAIN LAZAAR
++++++++++SUBJECT: LOG OF MUNDUS CENTRUM CAMPAIGN
++++++++++THOUGHT: A MOMENT OF LAXITY SPAWNS A LIFETIME OF HERESY.


	248.853.M41: Following the leads we received from Brother Interrogator Chaplain Asmodai, we made haste to Sector Mundus Centrum. Upon translation from warp space, we were immediately set upon by one of the Great Devourer’s many tendrils. The battle in high orbit above Mundus Centrum would have delayed our landing onto the main continent for weeks had not the unheralded arrival of a large contingent of Necron tomb ships not caught the Tyranid bio-forms unawares.  Void battle was joined between the Tyranid and Necron ships, and we used this brief respite to land a small force of our brothers planet-side in the North East region of the continent (Imperial Designation: Rhun). I have accompanied my fellow marines to lead from the field, leaving Brother Aralith in command of the fleet.

	The derelict star port in South Rhun is in some disrepair, but it will suffice for our purposes as an operational command center.  Brother Techmarine Ophaniel reports that with some maintenance, we may be able to link the other abandoned star ports on the continent and reactivate the dormant orbital defense systems, allowing us to target the xenos interlopers and cleanse local space of their alien taint.

	In our descent to Rhun, augurs picked up a disturbing number of returns from other craft entering the atmosphere.  To the South, it appears the shambling Necron host has endeavored to gain a foothold in the former capital region (Imperial Designation: Gondor).  To the West, bio-forms of the insatiable Tyranids have assumedly already begun to consume and destroy one of the continent’s main agricultural regions (Imperial Designation: Eriador).

	The presence of these xenos armies will surely slow the hunt for our quarry, but we will persevere undeterred.  For the Emperor.  For the Lion.
```

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", 1,   "move",  c("D3", "C2")) %>%
  modify_unit("big_grizz", c(2, 7, 17, 18),   "control",  "D4") %>%
  modify_unit("big_grizz", c(3, 5:6, 13, 22),   "soar",  c("F5S", "H2S", "H2")) %>% # transport
  modify_unit("big_grizz", c(8, 23),   "move",  c("D3", "C4", "C5")) %>% # transport
  modify_unit("big_grizz", 9,   "move",  "F5") %>%
  modify_unit("big_grizz", c(10:12, 16),   "move",  c("D2", "D1")) %>%
  modify_unit("big_grizz", c(14:15, 19:21),   "move",  "F5") %>%
  modify_unit("eric",      c(1:6, 13:14, 8:11),   "move",  "E7") %>%
  modify_unit("eric",      7,     "control","G7") %>%
  modify_unit("eric",      12,     "move", c("E7", "E5")) %>%
  modify_unit("eric",      15:18,   "soar", c("G8S", "G10S", "I1S", "I3S")) %>% # transport IS THIS LEGAL? do you need to use a move to land?
  modify_unit("eric",      19,   "move","G6") %>%
  modify_unit("eric",      20,   "move", c("E7", "E6")) %>%
  modify_unit("eric",      21,   "move", c("E7", "E4")) %>% 
  modify_unit("eric",      c(22:24, 26),   "soar", c("G8S", "H3S", "H3")) %>% # transport 
  modify_unit("eric",      25,   "move","G8") %>%
  modify_unit("eric",      27,   "move", c("E7", "F4")) %>%
  modify_unit("eric",      28,   "move", c("E7", "F8")) %>% # cool example here of if you got waylaid in E7 you would have strength together
  modify_unit("chris",     c(6, 13),  "move","A2") %>%
  modify_unit("chris",     c(5, 7, 8, 12, 23),  "move","A3") %>%
  modify_unit("chris",     1,  "move","A4") %>%
  modify_unit("chris",     c(10, 14, 24),  "move","A6") %>%
  modify_unit("chris",     c(3, 9, 17, 18, 22),  "move","A7") %>%
  modify_unit("chris",     2,  "move", c("A6", "A8")) %>%
  modify_unit("chris",     19,  "move",c("B7", "B10")) %>%
  modify_unit("chris",     21,  "move", c("B9", "B11")) %>%
  modify_unit("chris",     c(4, 15),  "move","B7") %>%
  modify_unit("chris",     20,  "move", c("A7", "E1")) %>%
  modify_unit("chris",     c(11, 16, 25),  "control","A5") %>%
  reconcile_player_orders()

```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# TURN 2 {#turn2}
```
	249.853.M41: Controlling actions are underway.  We are casting our nets wide.  Capture is only a matter of time.

	Brother Techmarine Myrdean reports that a moderate warband of Necrons has landed nearby his position in the South (Imperial Designation: Mordor). He expects conflict within 15 hours.
```

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", 1,   "move",  c("C1", "B4")) %>%
  modify_unit("big_grizz", 7,   "move",  "D2") %>%
  modify_unit("big_grizz", 6,   "move",  "H5") %>%
  modify_unit("big_grizz", c(3, 5, 13, 22),   "control",  "H2") %>%
  modify_unit("big_grizz", c(8, 23),   "control",  "C5") %>%
  modify_unit("big_grizz", 9,   "control",  "F5") %>%
  modify_unit("big_grizz", c(10:12, 16),   "move",  c("B1", "B4")) %>%
  modify_unit("big_grizz", c(14:15, 19:21),   "move",  "C5") %>%
  modify_unit("eric",      c(1:6, 13:14, 8:11),   "move",  "E5") %>%
  modify_unit("eric",      7,     "move","E7") %>%
  modify_unit("eric",      12,     "move", c("F3", "F2")) %>%
  modify_unit("eric",      c(15, 16,18),     "move","I4") %>%
  modify_unit("eric",      17,   "control","I3") %>%
  modify_unit("eric",      19,   "control","G6") %>%
  modify_unit("eric",      20,   "move", c("E4", "E3")) %>%
  modify_unit("eric",      21,   "move", c("E1", "A8")) %>%
  modify_unit("eric",      c(22:24, 26),   "move","H2") %>%
  modify_unit("eric",      25,   "control","G8") %>%
  modify_unit("eric",      27,   "move", c("F7", "F5")) %>%
  modify_unit("eric",      28,   "move", c("H1", "H3")) %>%
  modify_unit("chris",     c(6),  "move","A4") %>%
  modify_unit("chris",     c(13),  "control","A2") %>%
  modify_unit("chris",     c(5, 12, 23),  "move","B2") %>%
  modify_unit("chris",     c(7, 8),  "control","A3") %>%
  modify_unit("chris",     1,  "move", c("A6", "A8")) %>%
  modify_unit("chris",     c(14),  "control","A6") %>%
  modify_unit("chris",     c(10, 24),  "move","A8") %>%
  modify_unit("chris",     c(3,17, 18, 22),  "move","B9") %>%
  modify_unit("chris",     c(9),  "control","A7") %>%
  modify_unit("chris",     2,  "move", "E1") %>%
  modify_unit("chris",     19,  "move", c("B11", "E1")) %>%
  modify_unit("chris",     21,  "move","B6") %>%
  modify_unit("chris",     4,  "move","B8") %>%
  modify_unit("chris",     15,  "move","B9") %>%
  modify_unit("chris",     20,  "move", c("B11", "E2")) %>%
  modify_unit("chris",     11,  "move","B7") %>%
  modify_unit("chris",     c(16, 25),  "control","A5") %>%
  reconcile_player_orders()
```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

### moves

```{r}
# retreats
game <- game %>%
  modify_unit("eric", "F5",   "move","F8") %>%
  kill_unit("eric", 21) %>%
  modify_unit("eric", "H2",   "move","H3") %>%
  reconcile_player_orders()
```

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```


# TURN 3 {#turn3}
```
250.853.M41: Brother Techmarine Myrdean has successfully repelled a Necron attack to his position at the star port Barad-Dur. The Storm Raven Barador was invaluable in this defense, but Myrdean fears the Necrons are merely testing our strength and resolve before mounting larger attacks. Defensive infrastructure must be built quickly to solidify our grip in Mordor.

	Squad Galizur was also met with some resistance in the expansive territory of the Brown Lands.  A small and meddlesome force of scarabs tried, unsuccessfully, to halt Galizur’s progress in bringing the territory under our control.  Such small storms can be easily weathered.  I am concerned the coming tempest may prove otherwise. The Emperor Protects. 
```

### moves

```{r}
game <- game %>%
  modify_unit("big_grizz", c(1, 10, 11, 12, 16),   "move",  c("B1", "B3")) %>%
  modify_unit("big_grizz", 7,   "control",  "D2") %>%
  modify_unit("big_grizz", 6,   "control",  "H5") %>%
  modify_unit("big_grizz", c(3, 5, 13, 22),   "move",  "H3") %>%
  modify_unit("big_grizz", c(8, 20, 21, 23),   "move",  "C3") %>%
  modify_unit("big_grizz", 9,   "sneak",  "C4") %>%
  modify_unit("big_grizz", c(4, 15, 19),   "sneak",  "C3") %>%
  modify_unit("big_grizz", 14,   "reinforce",  "C5") %>%
  
  modify_unit("eric", 1, "move",	"F3") %>%
  modify_unit("eric", 2, "move",	"F3") %>%
  modify_unit("eric", 3, "move",	"F4") %>%
  modify_unit("eric", 4, "move",	"F3") %>%
  modify_unit("eric", 5, "move",	"F3") %>%
  modify_unit("eric", 6, "move",	"F3") %>%
  modify_unit("eric", 7, "move",	"E5") %>%
  modify_unit("eric", 8, "move",	"F4") %>%
  modify_unit("eric", 9, "move",	"F3") %>%
  modify_unit("eric", 10, "move",	"F4") %>%
  modify_unit("eric", 11, "move",	"F3") %>%
  modify_unit("eric", 12, "move",	c("C3", "F7")) %>%
  modify_unit("eric", 13, "move",	"F3") %>%
  modify_unit("eric", 14, "sneak",	"E5") %>%
  modify_unit("eric", 15, "move",	"I5") %>%
  modify_unit("eric", 16, "move",	"I5") %>%
  modify_unit("eric", 17, "move",	"I4") %>%
  modify_unit("eric", 18, "control",	"I4") %>%
  modify_unit("eric", 19, "move",	"G9") %>%
  modify_unit("eric", 20, "move",	"E4") %>%
  modify_unit("eric", 21, "rejoin",	"G7") %>%
  modify_unit("eric", 22, "move",	"H5") %>%
  modify_unit("eric", 23, "move",	"H5") %>%
  modify_unit("eric", 24, "move",	"H5") %>%
  modify_unit("eric", 25, "move",	"G10") %>%
  modify_unit("eric", 26, "move",	"H5") %>%
  modify_unit("eric", 27, "move",	"F7") %>%
  modify_unit("eric", 28, "reinforce",	"H3") %>%

  modify_unit("chris", c(20), "defend", "E2") %>%
  modify_unit("chris", c(5, 23), "defend", "B2") %>%
  modify_unit("chris", c(16, 25), "defend", "A5") %>%
  modify_unit("chris", 3, "sneak", "B11") %>%
  modify_unit("chris", c(1,17,18) , "move", "B11") %>%
  modify_unit("chris", 2, "move", "E2") %>%
  modify_unit("chris", c(4) , "sneak", "B2") %>%
  modify_unit("chris", c(7) , "move", "B2") %>%
  modify_unit("chris", 6, "move", "A1") %>%
  modify_unit("chris", 8, "move", "B5") %>%
  modify_unit("chris", 9, "sneak", "B9") %>%
  modify_unit("chris", c(10) , "sneak", "E1") %>%
  modify_unit("chris", c(24) , "move", "E1") %>%
  modify_unit("chris", 11, "control", "B7") %>%
  modify_unit("chris", 12, "control", "B2") %>%
  modify_unit("chris", 13, "move", "A4") %>%
  modify_unit("chris", 14, "move", "A8") %>%
  modify_unit("chris", 15, "control", "B9") %>%
  modify_unit("chris", 19, "move", "E3") %>%
  modify_unit("chris", 21, "move", "B3") %>%
  modify_unit("chris", 22, "move", "B7") %>%
  add_bridge("A8", "E1") %>% # chris

  reconcile_player_orders()
```

Attempt to reconcile moves.

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```


```{r}
# retreats
game <- game %>%
  modify_unit("chris",     "B3",  "move","B2") %>%
  modify_unit("eric", "C3",   "move",  "F3") %>%
  modify_unit("eric", "H5",   "move",  "H4") %>%
  modify_unit("eric", "H3",   "move",  "H1") %>%
  reconcile_player_orders()
```

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# TURN 4 {#turn4}

```
251.853.M41: Ravenwing Talonmaster Castiel has demonstrated unparalleled prowess as a hunter of the Second Company.  I have inducted him further into the ranks of the Inner Circle, and expect his name will be well-remembered in the halls of The Rock.  While scouting the northern reaches of Angmar, Castiel came upon a swarm of winged creatures (Imperial Designation: Gargoyles). Unfortunately, the vermin escaped before they could be properly put to the sword.  It seems the voracious appetite of the Great Devourer knows some bounds after all.

Our forces in the densely forested region (Imperial Designation: Mirkwood) came across another small, scouting contingent of Necron scarabs.  Negligible resistance met.  Similarly, Brother Techmarine Myrdean came into contact with constructs of the same variety in the southern territory of Mount Doom.  While dealing with these insectoid nuisances is a trivial matter, the broader goal of the Necrons remains a mystery, and is therefore disquieting. 

The retreat of the Necrons from Myrdean’s wrath in yesterday’s battle for Barad-Dur was an apparent feint.  All available intelligence led Myrdean to believe this small band had fled due-East from his location, and he gave chase only to find the aforementioned scarabs. The true destination of the Necrons was later discovered to be the territory of Gorgoroth, where Squad Naamand was caught in the open as they were setting up the defenses.  Emperor be praised, Naamand was able to signal us in the South Rhun star port before his squad could be overrun.  Brothers Abathar and Apharan of the Deathwing accompanied me with their squads to the front, and we were only just able to stem that tide of living metal from rising over Gorgoroth.

We are undaunted, and we know no fear!
```

### moves

```{r}
game <- game %>%

  modify_unit("big_grizz", c(1, 10, 11, 12, 16),   "move",  c("B1", "B4")) %>%
  modify_unit("big_grizz", 7,   "move",  "D1") %>%
  modify_unit("big_grizz", 6,   "move",  "H6") %>%
  modify_unit("big_grizz", 5,   "control",  "H3") %>%
  modify_unit("big_grizz", c(3, 13, 22),   "move",  c("H3", "H4")) %>%
  modify_unit("big_grizz", c(8, 23),   "control",  "C3") %>%
  modify_unit("big_grizz", 21,   "move",  "F2") %>%
  modify_unit("big_grizz", 9,   "control",  "C4") %>%
  modify_unit("big_grizz", c(4, 15, 19, 20),   "sneak",  "F2") %>%
  modify_unit("big_grizz", 14,   "reinforce",  "C5") %>%
  modify_unit("big_grizz", 2,   "move",  "H2") %>%
  modify_unit("big_grizz", c(17, 18),   "move",  "H4") %>%
  
  modify_unit("eric",  1,  "move",          "E5") %>%
  modify_unit("eric",  2,  "move",          "E5") %>%
  modify_unit("eric",  3,  "move",          "E5") %>%
  modify_unit("eric",  4,  "move",          "E5") %>%
  modify_unit("eric",  5,  "move",          "E5") %>%
  modify_unit("eric",  6,  "move",          "E5") %>%
  modify_unit("eric",  7,  "control",       "E5") %>%
  modify_unit("eric",  8,  "move",          "E5") %>%
  modify_unit("eric",  9,  "move",          "E5") %>%
  modify_unit("eric",  10,  "move",         "E5") %>%
  modify_unit("eric",  11,  "move",         "E5") %>%
  modify_unit("eric",  12,  "move",         "E5") %>%
  modify_unit("eric",  13,  "move",         "E5") %>%
  modify_unit("eric",  14,  "move",         "E5") %>%
  modify_unit("eric",  15,  "soar",        c("I5S", "H6S", "H6")) %>%
  modify_unit("eric",  16,  "soar",        c("I5S", "H6S", "H6")) %>%
  modify_unit("eric",  17,  "soar",        c("I4S", "H6S", "H6")) %>%
  modify_unit("eric",  18,  "soar",        c("I4S", "H6S", "H6")) %>%
  modify_unit("eric",  19,  "control",      "G9") %>%
  modify_unit("eric",  20,  "reinforce",    "E4") %>%
  modify_unit("eric",  21,  "move",         c("G8", "H4")) %>%
  modify_unit("eric",  22,  "reinforce",    "H4") %>%
  modify_unit("eric",  23,  "reinforce",    "H4") %>%
  modify_unit("eric",  24,  "reinforce",    "H4") %>%
  modify_unit("eric",  25,  "control",      "G10") %>%
  modify_unit("eric",  26,  "control",      "H4") %>%
  modify_unit("eric",  27,  "reinforce",    "F7") %>%
  modify_unit("eric",  28,  "reinforce",    "H1") %>%

  modify_unit("chris", c(2, 4, 16, 19, 20, 21, 23, 25), "reinforce") %>%  
  modify_unit("chris", c(1),  "move", c("B8", "B2")) %>%
  modify_unit("chris", c(3),  "sneak", "E1") %>%
  modify_unit("chris", c(5),  "move", "B1") %>%
  modify_unit("chris", c(6),  "control", "A1") %>%
  modify_unit("chris", c(7),  "move", "B6") %>%
  modify_unit("chris", c(8),  "control", "B5") %>%
  modify_unit("chris", c(9),  "sneak", "B10") %>%
  modify_unit("chris", c(10), "control", "E1") %>%
  modify_unit("chris", c(11), "move", "B8") %>%
  modify_unit("chris", c(12), "move", "B1") %>%
  modify_unit("chris", c(13), "control", "A4") %>%
  modify_unit("chris", c(14), "control", "A8") %>%
  modify_unit("chris", c(15), "move", "B11") %>%
  modify_unit("chris", c(17), "move", "E2") %>%
  modify_unit("chris", c(18), "move", "E2") %>%
  modify_unit("chris", c(22), "move", "B2") %>%
  modify_unit("chris", c(24), "move", "E3") %>%

  reconcile_player_orders()
```

```{r}
print(draw_map(game, "{{PLAYER}}"))
print_map_df(game, "{{PLAYER}}")
```

# Discussion Notes

* I updated the multi-territory moves for the first two turns. Are we cool with my decisions?
* ~~The way I have it, after you move you can only see the units in combat. You don't get to see the full board until _after_ combat is resolved. This was intentional on my part, but do we like this?~~ Ok, I changed this. I think it's much better this way. Red circles on the map show battles and there's a `CONFLICT!` column where relevant in your table. Plus, now you can only see the battles you're involved with.
* Whose gonna write me a battle story for this turn?

**Rmd Hash:** {{RMD_MD5}}

**Code Commit Hash:** {{CODE_HASH}}
